/*! Version: aab-analytics-event-handler 1.0.11 sc-analytics-api 0.0.5 3/12/2020 11:42:32 AM */
!function(n){var a={};function o(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}({"./node_modules/sc-analytics-api/src/ScAnalyticsApi.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./node_modules/sc-analytics-api/src/dataMapper.js");function o(e,t){-1<document.cookie.indexOf("utagdb=true")&&console.log(e,t)}var r={eventTrack:function(e){var t,n=(0,a.eventMapper)(e);null!=n&&(t=n,null!=window.utag?(window.utag.link(t),o("sc-analytics-api: utag.link called with payload:",t)):o("sc-analytics-api: no pageview sent because utag.js wasn't loaded (yet)",t))},pageTrack:function(e){var t,n=(0,a.pageMapper)(e);null!=n&&(t=n,null!=window.utag?(window.utag.view(t),o("sc-analytics-api: utag.view called with payload:",t)):o("sc-analytics-api: no pageview sent because utag.js wasn't loaded (yet)",t))}};t.default=r},"./node_modules/sc-analytics-api/src/dataMapper.js":function(e,t,n){"use strict";function l(e){return e||void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.eventMapper=function(e){var t={},n=["eventName","eventAction","eventCategory"],a=Object.keys(e),o=a.includes(n[0]),r=a.includes(n[1]),i=a.includes(n[2]);!0===o&&!0===r&&!0===i?(t.event_name=e.eventName,t.event_action=e.eventAction,t.event_category=l(e.eventCategory),t.event_custom=l(e.eventCustom),t.event_is_interaction=l(e.eventIsInteraction),t.event_label=l(e.eventLabel)):(console.warn('sc-analytics-api: Mandatory keys and values are not correct! Make sure that "eventName", "eventAction" and "eventCategory" are sent correctly'),t=void 0);return t},t.pageMapper=function(e){var t={},n=["widgetName","widgetTitle","widgetModule","widgetState","eventName"],a=Object.keys(e),o=a.includes(n[0]),r=a.includes(n[1]),i=a.includes(n[2]),s=a.includes(n[3]),c=a.includes(n[4]);!0===o&&!0===r&&!0===i&&!0===s&&!0===c?(t.widget_name=e.widgetName,t.widget_title=e.widgetTitle,t.widget_module=e.widgetModule,t.widget_state=e.widgetState,t.event_name=l(e.eventName),t.widget_substate=l(e.subState),t.event_custom=l(e.eventCustom),null!=e.productCategory&&null!=e.productName&&null!=e.productQuantity&&null!=e.productPrice&&(t.product_category=l(e.productCategory),t.product_name=l(e.productName),t.product_quantity=l(e.productQuantity),t.product_price=l(e.productPrice))):(console.warn('sc-analytics-api: Mandatory keys and values are not correct! Make sure that "widgetName", "widgetTitle", "widgetModule", "widgetState" and "eventName" are sent correctly'),t=void 0);return t}},"./src/aab-analytics-event-handler.ts":function(e,u,t){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var d=t("./node_modules/sc-analytics-api/src/ScAnalyticsApi.js");u.AabAnalyticsEventHandlerExport=function(){var r,e,a,t,i=["A","DIV","BUTTON","LABEL","IMG"];(e=r=r||{}).COMPONENT_TYPE="data-component-type",e.ELEMENT_TYPE="data-element-type",e.LABEL="data-element-label",e.CUSTOM_OBJECT="data-custom-object",(t=a=a||{}).ODA_SS_DEBUG_KEY="oda-ss-db",t.COMPONENT_NAME="aab-analytics-event-handler";var o="*",s="aab-",n=(c.prototype.init=function(){var e,t=this;t._event?(t._eventAction=t.getEventAction(),t._eventCategory=t.getEventCategory(),t._eventLabel=t.getEventLabel(),t._eventCustom=t.getEventCustom(),t._eventName&&t._eventAction&&t._eventCategory&&(e=new l({eventName:t._eventName,eventAction:t._eventAction,eventCategory:t._eventCategory,eventLabel:t._eventLabel,eventIsInteraction:t._eventIsInteraction,eventCustom:t._eventCustom}))):t._ce&&(e=t.mapModel()),e&&t.sendAnalyticsEventData(e)},c.prototype.getEventCategory=function(){var e=u.AabAnalyticsEventHandlerExport.getClosest(this._srcElement,"["+r.COMPONENT_TYPE+"]");if(e){var t=e.getAttribute(r.COMPONENT_TYPE);return t||""}return""},c.prototype.getEventAction=function(){var e=this,t=e._srcElement.getAttribute(r.ELEMENT_TYPE);return e._eventName=t||"btn-link",e._eventIsInteraction=!0,e._eventType+":"+e._eventName},c.prototype.getEventLabel=function(){var e=this._srcElement.getAttribute(r.LABEL);return e||this._srcElement.innerText},c.prototype.getEventCustom=function(){if(this._srcElement){var e=this._srcElement.getAttribute(r.CUSTOM_OBJECT);if(e){var t=void 0;try{e=e.replace(/'/g,'"'),t=JSON.parse(e)}catch(e){}return t&&"object"==typeof t?t:void 0}}},c.prototype.mapModel=function(){var e;if(this._ce.detail){var t=this._ce.detail;if("eventName"in t&&"eventCategory"in t&&"eventAction"in t){var n="eventLabel"in t?t.eventLabel:void 0,a="eventCustom"in t&&"object"==typeof t.eventCustom?t.eventCustom:void 0;e=new l({eventName:t.eventName,eventAction:t.eventAction,eventCategory:t.eventCategory,eventLabel:n,eventIsInteraction:t.eventIsInteraction,eventCustom:a})}}return e},c.prototype.sendAnalyticsEventData=function(e){try{window.utag||(e.eventCustom.techInfo="aab-analytics-event-handler: window.utag undefined")}catch(e){}this.odaDebugLogMessage("aab-analytics-event-handler:"+JSON.stringify(e)),this.odaDebugGetMessages(),d.default.eventTrack(e)},c.getClosest=function(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n});e&&e!==document;e=e.parentNode)try{if(e&&e.matches(t))return e}catch(e){}return null},c.isValidEvent=function(t){var e=!(1!==i.filter(function(e){return e===t.srcElement.nodeName}).length),n=!(!t.srcElement.parentNode||"#document-fragment"!==t.srcElement.parentNode.nodeName),a=!!t.srcElement.getAttribute(r.ELEMENT_TYPE)&&!n,o=!!(e&&a||a);return o||"A"!==t.srcElement.nodeName?o:!!u.AabAnalyticsEventHandlerExport.getClosest(t.srcElement,"div.richtext")},c.getWebComponents=function(){for(var e=[],t=document.getElementsByTagName(o),n=0;n<t.length;n++)-1!==t[n].tagName.toLocaleLowerCase().indexOf(s)&&e.push(t[n]);return e},c.setupAnalyticsEventHandler=function(e,t){var n;e&&u.AabAnalyticsEventHandlerExport.isValidEvent(e)?n=new u.AabAnalyticsEventHandlerExport(e):t&&"analytics-event-handler"===t.type&&(n=new u.AabAnalyticsEventHandlerExport(null,t)),n&&n.init()},c.prototype.odaDebugLogMessage=function(e){this._odaDb&&e&&this._odaDbMessages.push(e)},c.prototype.odaDebugGetMessages=function(){this._odaDb&&this._odaDbMessages&&0<this._odaDbMessages.length&&sessionStorage.setItem(a.COMPONENT_NAME,this._odaDbMessages.join("|||"))},c);function c(e,t){this._odaDbMessages=[];var n=this;n._odaDb=!("true"!==sessionStorage.getItem(a.ODA_SS_DEBUG_KEY)),sessionStorage.getItem(a.COMPONENT_NAME)&&sessionStorage.removeItem(a.COMPONENT_NAME),e?(n._event=e,n._eventType=n._event.type,n._srcElement=e.srcElement,n._srcElementName=e.srcElement.nodeName?e.srcElement.nodeName:""):t&&(n._ce=t)}var l=function(e){var t=e.eventName,n=e.eventAction,a=e.eventCategory,o=e.eventLabel,r=e.eventIsInteraction,i=e.eventCustom,s=this;s.eventName=t,s.eventAction=n,s.eventCategory=a,s.eventLabel=o,s.eventIsInteraction=r,s.eventCustom=i};return n}(),u.default=u.AabAnalyticsEventHandlerExport,document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",function(e){u.AabAnalyticsEventHandlerExport.setupAnalyticsEventHandler(e)}),Array.prototype.forEach.call(u.AabAnalyticsEventHandlerExport.getWebComponents(),function(e){e&&e.shadowRoot&&e.shadowRoot.addEventListener("click",function(e){u.AabAnalyticsEventHandlerExport.setupAnalyticsEventHandler(e)})}),document.addEventListener("analytics-event-handler",function(e){e.detail&&u.AabAnalyticsEventHandlerExport.setupAnalyticsEventHandler(null,e)})})},0:function(e,t,n){e.exports=n("./src/aab-analytics-event-handler.ts")}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhYWItYW5hbHl0aWNzLWV2ZW50LWhhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiIn0=